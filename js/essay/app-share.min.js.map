{"version":3,"sources":["essay/app-share.min.js"],"names":["_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_classCallCheck","instance","Constructor","_typeof","Symbol","iterator","obj","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","Pagination","options","this","setOptions","callback","bindEvent","opt","defaults","total","prePages","sufPages","dotsPages","showDotPages","sidePages","container","numberStyle","$","extend","pageIndex","totalCount","_this","str","append","undelegate","delegate","event","$this","parseInt","text","type","data","oldIndex","attr","hasClass","Plugin","element","$element","$Audio","children","Audio","$audio_area","find","$audio_length","$audio_progress","currentState","time","init","pluginName","dataName","version","autoplay","src","noop","addEventListener","e","updateTotalTime","duration","console","log","events","changeSrc","play","pause","clearInterval","timer","setInterval","run","bind","addClass","removeClass","stop","updateTime","on","animateProgressBarPosition","ended","percentage","currentTime","styles","width","css","getAudioSeconds","string","addZero","Math","floor","getAudioMinutes","word","howManyZero","String","minutes","seconds","audioTime","old","fn","option","args","each","noConflict","window","Zepto","jQuery","ArticleShareController","_Controller","opts","_this2","getPrototypeOf","require","BigData","bigData","pageName","pageParam","article_id","trim","val","setArticleFont","articleId","cityId","refreshComment","convertLink","convertVideo","openInApp","initWxShare","loginStatus","textareaHeight","height","wkBigDataParams","eventName","eventParam","nextPageName","nextPageParam","city","location","href","indexOf","slice","lastIndexOf","clearTimeout","st","setTimeout","scrollTop","offset","top","click","nativeSchema","loadSchema","schema","protocal","loadWaiting","failUrl","apkInfo","PKG","CATEGORY","ACTION","params","name","reg","RegExp","r","match","context","classSelf","links","index","item","$item","categoryId","split","getQueryString","videos","$video","audio","coverUrl","toLowerCase","after","remove","poster","preload","wechatAudio","PN","itemIndex","request","apiUrl","essay","commentList","successCallback","result","createCommentList","empty","count","show","genPageNumber","ceil","hide","html","push","guestPhoto","guestNickname","replace","commentContent","date","join","removeAttr","_","$icon","first","Login","isLoginCheck","Operation","collect","showMessage","lifang","sendWKBigData","cancelCollection","addListenerToDownloadApp","padding-bottom","tips","zan","status","zanCount","test","keyup","parent","color","border-color","com","commiting","preventDefault","$textarea","comment","$count","commentNumStr","$comment","scrollIntoView","Controller","document","ready"],"mappings":"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","file":"app-share.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n 1. 项目名称：悟空找房h5\r\n 2. 页面名称：article/app-share(取经文章-分享页)\r\n 3. 作者：tangxuyang@lifang.com\r\n 4. 从wkwap_fe中移过来的，简单修改\r\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n\r\n // 取自pagination.js\r\n class Pagination {\r\n     constructor(options) {\r\n        this.setOptions(options);\r\n        this.options.callback();\r\n        this.bindEvent();\r\n     }\r\n\r\n    setOptions(opt) {\r\n        var defaults = {\r\n          total: 1,\r\n          prePages: 5, // 没有前置[...]显示5页\r\n          sufPages: 4, // 没有后置[...]显示4页\r\n          dotsPages: 7, // 7页后显示[...]\r\n          showDotPages: 3, // 前后3页之后显示[...]  \r\n          sidePages: 1, // 中间前后各加1页\r\n          callback: null,\r\n          container: null,\r\n          numberStyle: ''\r\n        };\r\n        $.extend(true, this.options = {}, defaults, opt);\r\n    }\r\n \r\n    genPageNumber(pageIndex, totalCount) {\r\n        var _this = this;\r\n        var prePages = _this.options.prePages; // 没有前置[...]显示5页\r\n        var sufPages = _this.options.sufPages; // 没有后置[...]显示4页\r\n        var dotsPages = _this.options.dotsPages; // 7页后显示[...]\r\n        var showDotPages = _this.options.showDotPages; // 前后3页之后显示[...]  \r\n        var sidePages = _this.options.sidePages; // 中间前后各加1页\r\n        var total = totalCount || _this.options.total;\r\n        var numberStyle = _this.options.numberStyle;\r\n        var str = \"<a href='javascript:;' class='\" + numberStyle + \" page-link on'>\" + pageIndex + '</a>';\r\n        if (total < dotsPages) {\r\n          for (var i = pageIndex - 1; i >= 1; i--) {\r\n            str = \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + i + '</a>' + str;\r\n          }\r\n          for (var i = pageIndex + 1; i <= total; i++) {\r\n            str = str + \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + i + '</a>';\r\n          }\r\n        } else {\r\n          if (pageIndex < showDotPages + 1) {\r\n            for (var i = pageIndex - 1; i >= 1; i--) {\r\n              str = \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + i + '</a>' + str;\r\n            }\r\n            for (var i = pageIndex + 1; i <= prePages; i++) {\r\n              str = str + \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + i + '</a>';\r\n            }\r\n            str = str + '<span>...</span>';\r\n            str = str + \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + total + '</a>';\r\n          } else if (total - pageIndex < showDotPages) {\r\n            for (var i = pageIndex + 1; i <= total; i++) {\r\n              str = str + \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + i + '</a>';\r\n            }\r\n            for (var i = pageIndex - 1; i > total - sufPages; i--) {\r\n              str = \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + i + '</a>' + str;\r\n            }\r\n            str = '<span>...</span>' + str\r\n            str = \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + 1 + '</a>' + str;\r\n          } else {\r\n            for (var i = 1; i <= sidePages; i++) {\r\n              if (pageIndex - i > 1) {\r\n                str = \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + (pageIndex - i) + '</a>' + str;\r\n              }\r\n              if (pageIndex - 0 + i <= total) {\r\n                str = str + \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + (pageIndex - 0 + i) + '</a>';\r\n              }\r\n            }\r\n            if (pageIndex - sidePages > 1) {\r\n              str = \"<a href='javascript:;' class='page-link'>\" + 1 + '</a>' + '<span>...</span>' + str;\r\n            }\r\n            if (pageIndex + sidePages < total) {\r\n              str = str + '<span>...</span>' + \"<a href='javascript:;' class='\" + numberStyle + \" page-link'>\" + total + '</a>';\r\n            }\r\n          }\r\n        }\r\n        if (pageIndex == 1) {\r\n          str = \"<a href='javascript:;' data-type='pre' data-pageindex='\" + pageIndex + \"' class='page-link disabled'>上一页</a>\" + str;\r\n        } else {\r\n          str = \"<a href='javascript:;' data-type='pre' data-pageindex='\" + pageIndex + \"' class='page-link'>上一页</a>\" + str;\r\n        }\r\n  \r\n        if (pageIndex == total) {\r\n          str = str + \"<a href='javascript:;' data-type='next' data-pageindex='\" + pageIndex + \"' class='page-link disabled'>下一页</a>\";\r\n        } else {\r\n          str = str + \"<a href='javascript:;' data-type='next' data-pageindex='\" + pageIndex + \"' class='page-link'>下一页</a>\";\r\n        }\r\n        _this.options.container.append(str);\r\n    }\r\n    \r\n    bindEvent() {\r\n        var _this = this;\r\n        _this.options.container.undelegate('a', 'click').delegate('a', 'click', function (event) {\r\n          var $this = $(this);\r\n          var pageIndex = parseInt($this.text());\r\n          var type = $this.data('type');\r\n          var oldIndex = parseInt($this.attr('data-pageindex'));\r\n          if ($this.hasClass('disabled') || $this.hasClass('on')) return;\r\n          switch (type) {\r\n            case 'pre':\r\n              pageIndex = oldIndex - 1;\r\n              break;\r\n            case 'next':\r\n              pageIndex = oldIndex + 1;\r\n              break;\r\n            default:\r\n              break;\r\n          }\r\n          if (!pageIndex) return;\r\n          _this.options.callback && _this.options.callback(pageIndex);\r\n        });\r\n      }\r\n} \r\n  \r\n// 取自wechatAudio.js\r\n;\r\n(function($) {\r\n    'use strict';\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------\r\n    定义插件的构造方法\r\n    @param element 选择器对象\r\n    @param options 配置项\r\n    @constructor\r\n    -----------------------------------------------------------------------------------------------------------*/\r\n    var Plugin = function(element, options) {\r\n        //将选择器对象赋值给插件，方便后续调用\r\n        this.$element = $(element);\r\n\r\n        this.$Audio = this.$element.children('#media');\r\n        this.Audio = this.$Audio[0];\r\n        this.$audio_area = this.$element.find('#audio_area');\r\n        this.$audio_length = this.$element.find('#audio_length');\r\n        this.$audio_progress = this.$element.find('#audio_progress');\r\n        //属性\r\n        this.currentState = 'pause';\r\n        this.time = null;\r\n        //合并参数设置\r\n        this.options = $.extend({}, Plugin.defaults, options);\r\n        //进行一些初始化工作\r\n        this.init();\r\n    };\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------\r\n    插件名称，即调用时的名称（$.fn.pluginName）\r\n    @type {string}\r\n    -----------------------------------------------------------------------------------------------------------*/\r\n    Plugin.pluginName = \"wechatAudio\";\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------\r\n    插件缓存名称，插件通过 data 方法缓存在 dom 结构里，存储数据的名称\r\n    @type {string}\r\n    -----------------------------------------------------------------------------------------------------------*/\r\n    Plugin.dataName = \"wechataudio\";\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------\r\n    插件版本\r\n    @type {string}\r\n    -----------------------------------------------------------------------------------------------------------*/\r\n    Plugin.version = \"1.0.0\";\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------\r\n    插件默认配置项\r\n    @type {{}}\r\n    -----------------------------------------------------------------------------------------------------------*/\r\n    Plugin.defaults = {\r\n        autoplay: false,\r\n        src: '',\r\n        callback: $.noop\r\n    };\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------\r\n    定义私有方法\r\n    -----------------------------------------------------------------------------------------------------------*/\r\n    var privateMethod = {\r\n\r\n    };\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------\r\n    定义插件的方法\r\n    @type {{}}\r\n    -----------------------------------------------------------------------------------------------------------*/\r\n    Plugin.prototype = {\r\n        init: function() {\r\n            var self = this;\r\n            self.Audio.addEventListener('durationchange', function(e) {\r\n                self.updateTotalTime(e.target.duration);\r\n                console.log(e.target.duration); //FIRST 0, THEN REAL DURATION\r\n            });\r\n            // window.addEventListener('load',function(){\r\n            //     self.updateTotalTime();\r\n            // })\r\n            self.events();\r\n            // 设置src\r\n            if (self.options.src !== '') {\r\n                self.changeSrc(self.options.src, this.options.callback);\r\n            }\r\n            // 设置自动播放\r\n            if (self.options.autoplay) {\r\n                self.play();\r\n            }\r\n        },\r\n        play: function() {\r\n            var self = this;\r\n            if (self.currentState === \"play\") {\r\n                self.pause();\r\n                return;\r\n            }\r\n            self.Audio.play();\r\n            clearInterval(self.timer);\r\n            self.timer = setInterval(self.run.bind(self), 50);\r\n            self.currentState = \"play\";\r\n            self.$audio_area.addClass('playing');\r\n        },\r\n        pause: function() {\r\n            var self = this;\r\n            self.Audio.pause();\r\n            self.currentState = \"pause\";\r\n            clearInterval(self.timer);\r\n            self.$audio_area.removeClass('playing');\r\n        },\r\n        stop: function() {\r\n\r\n        },\r\n        events: function() {\r\n            var self = this;\r\n            var updateTime;\r\n            self.$audio_area.on('click', function() {\r\n                self.play();\r\n                if (!updateTime) {\r\n                    self.updateTotalTime();\r\n                    updateTime = true;\r\n                }\r\n            });\r\n        },\r\n        //正在播放\r\n        run: function() {\r\n            var self = this;\r\n            self.animateProgressBarPosition();\r\n            if (self.Audio.ended) {\r\n                self.pause();\r\n            }\r\n        },\r\n        //进度条\r\n        animateProgressBarPosition: function() {\r\n            var self = this,\r\n                percentage = (self.Audio.currentTime * 100 / self.Audio.duration) + '%';\r\n            if (percentage == \"NaN%\") {\r\n                percentage = 0 + '%';\r\n            }\r\n            var styles = {\r\n                \"width\": percentage\r\n            };\r\n            self.$audio_progress.css(styles);\r\n        },\r\n        //获取时间秒\r\n        getAudioSeconds: function(string) {\r\n            var self = this,\r\n                string = string % 60;\r\n            string = self.addZero(Math.floor(string), 2);\r\n            (string < 60) ? string = string: string = \"00\";\r\n            return string;\r\n        },\r\n        //获取时间分\r\n        getAudioMinutes: function(string) {\r\n            var self = this,\r\n                string = string / 60;\r\n            string = self.addZero(Math.floor(string), 2);\r\n            (string < 60) ? string = string: string = \"00\";\r\n            return string;\r\n        },\r\n        //时间+0\r\n        addZero: function(word, howManyZero) {\r\n            var word = String(word);\r\n            // while (word.length < howManyZero) word = \"0\" + word;\r\n            return word;\r\n        },\r\n        //更新总时间\r\n        updateTotalTime: function(time) {\r\n             var self = this,\r\n                time = time || self.Audio.duration,\r\n                minutes = self.getAudioMinutes(time),\r\n                seconds = self.getAudioSeconds(time),\r\n                audioTime = '';\r\n                if(minutes == \"00\"){\r\n                    audioTime = seconds + \"''\"\r\n                }else{\r\n                    audioTime = minutes + \"'\" + seconds + \"''\";\r\n                }\r\n                self.$audio_length.text(audioTime);\r\n        },\r\n        //改变音频源\r\n        changeSrc: function(src, callback) {\r\n            var self = this;\r\n            self.pause();\r\n            self.Audio.src = src;\r\n            self.play();\r\n            callback();\r\n            return this;\r\n        },\r\n\r\n    };\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------\r\n    缓存同名插件\r\n    -----------------------------------------------------------------------------------------------------------*/\r\n    var old = $.fn[Plugin.pluginName];\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------\r\n    定义插件，扩展$.fn，为jQuery对象提供新的插件方法\r\n    调用方式：$.fn.pluginName()\r\n    @param option {string/object}\r\n    @param args {string/object}\r\n    -----------------------------------------------------------------------------------------------------------*/\r\n    $.fn[Plugin.pluginName] = function(option, args) {\r\n        return this.each(function() {\r\n            var $this = $(this);\r\n\r\n            var data = $this.data(Plugin.dataName);\r\n            var options = typeof option == 'object' && option;\r\n\r\n            //只实例化一次，后续如果再次调用了该插件时，则直接获取缓存的对象\r\n            if (!data) {\r\n                $this.data(Plugin.dataName, (data = new Plugin(this, options)));\r\n            }\r\n            //如果插件的参数是一个字符串，则直接调用插件的名称为此字符串方法\r\n            if (typeof option == 'string') data[option](args);\r\n            return this;\r\n        });\r\n    };\r\n\r\n    $.fn[Plugin.pluginName].Constructor = Plugin;\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------\r\n    为插件增加 noConflict 方法，在插件重名时可以释放控制权\r\n    @returns {*}\r\n    -----------------------------------------------------------------------------------------------------------*/\r\n    $.fn[Plugin.pluginName].noConflict = function() {\r\n        $.fn[Plugin.pluginName] = old;\r\n        return this\r\n    };\r\n})(window.Zepto || window.jQuery);\r\n\r\nclass ArticleShareController extends Controller {\r\n    constructor(opts){\r\n        super();\r\n\r\n        var self = this;\r\n        require(['../components/bigdata.min'], function(BigData){\r\n            BigData.init(self);\r\n            BigData.bigData({\r\n                \"pageName\": \"1022\",\r\n                \"pageParam\":{\r\n                    \"article_id\": $.trim($('#articleId').val())\r\n                },            \r\n                \"type\": 1\r\n            });\r\n            self.BigData = BigData;\r\n        });\r\n\r\n        // 设置参数\r\n        this.setOptions(opts)\r\n        this.setArticleFont()\r\n          // 初始化操作        \r\n        this.articleId = $.trim($('#articleId').val())\r\n        this.cityId = $.trim($('#cityId').val())\r\n          // 初始化评论列表\r\n        this.refreshComment()\r\n          // 绑定事件\r\n        this.bindEvent()\r\n        this.convertLink()\r\n        this.convertVideo()\r\n        this.openInApp()\r\n        this.initWxShare()\r\n        this.loginStatus = false\r\n        this.textareaHeight = $('.commentArea').find('textarea').height()\r\n        this.wkBigDataParams = {\r\n          pageName: 1022,\r\n          pageParam: {\r\n            article_id: this.articleId\r\n          },\r\n          eventName: '',\r\n          eventParam: {},\r\n          nextPageName: '',\r\n          nextPageParam: {},\r\n          city: $('#cityId').val()\r\n        }\r\n  \r\n        // 如果hash==\"#comment-box\",表示从栏目列表页跳转过来且已判断了用户是否登录了\r\n        // 则评论的输入框获取焦点\r\n        if (location.href.indexOf('#') > 0) {\r\n          if (location.href.slice(location.href.lastIndexOf('#')) == '#comment-box') {\r\n            clearTimeout(st)\r\n            var st = setTimeout(function() {\r\n              $('html,body').scrollTop($('#comment-box').offset().top - 200)\r\n            }, 300)\r\n          }\r\n        }\r\n    }\r\n\r\n    initWxShare() {\r\n        // var classSelf = this\r\n        // var wxShare = new WxShare({\r\n        //   successCB: function() {\r\n        //     classSelf.Operation.share({\r\n        //       articleId: classSelf.articleId\r\n        //     })\r\n        //   }\r\n        // })\r\n\r\n        // 微信分享功能已经打包进了app.min.js中，会自动在页面中寻找id为wechatTitle、wechatContent和wechatImgUrl的隐藏域，分别对应微信分享的标题、内容和图片！\r\n    }\r\n\r\n    openInApp() {\r\n        // 项目中【打开App】是一个组件，.download-app .download是这个组件使用的class\r\n        //nativeSchema是lib/wakeupApp提供的功能，已经打包到app.min.js中了，直接用就好了\r\n        var cityId = this.cityId;\r\n        var articleId = this.articleId;\r\n        $(\".download-app .download\").click(()=> {\r\n            nativeSchema.loadSchema({               \r\n                schema : \"external_call/parameter?t=0&bt=30&cd=\" + cityId + \"&articleId=\"+ articleId ,  // 通过NN打开某个链接\r\n                protocal : \"wkzf\" , //schema头协议，实际情况填写\r\n                loadWaiting : \"1500\" , //发起唤醒请求后，会等待loadWaiting时间，超时则跳转到failUrl，默认3000ms                \r\n                failUrl : \"https://m.wkzf.com/download/transit?from=esfDetail\" ,  //唤起失败时的跳转链接，默认跳转到下载页\r\n                // apk信息,请根据实际情况填写\r\n                apkInfo : {\r\n                    PKG : \"com.wukong.ua\" ,\r\n                    CATEGORY : \"android.intent.category.DEFAULT\" ,\r\n                    ACTION : \"android.intent.action.VIEW\"\r\n                }\r\n            }) ;\r\n        }) ;\r\n        // var app = new App({\r\n        //     element: '.downbtn',\r\n        //     androidSchemes: 'wkzf://external_call/parameter?t=0&bt=30&cd=' + this.cityId + '&articleId=' + this.articleId,\r\n        //     isoSchemes: 'wkzf://external_call/parameter?t=0&bt=30&cd=' + this.cityId + '&articleId=' + this.articleId,\r\n        //     androidDownloadLink: '/download/transit?from=articleDetail',\r\n        //     iosDownloadLink: '/download/transit?from=articleDetail'\r\n        // })\r\n    }\r\n\r\n    getQueryString(params, name) {\r\n        var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');\r\n        var r = params.match(reg); // 获取url中\"?\"符后的字符串并正则匹配\r\n        var context = '';\r\n        if (r != null)\r\n            context = r[2];\r\n        reg = null;\r\n        r = null;\r\n        return context == null || context == '' || context == 'undefined' ? '' : context;\r\n    }\r\n\r\n\r\n    convertLink() {\r\n        var classSelf = this;\r\n        var links = $('.article-content').find('a');// 找出.article-content中所有的a标签\r\n        if (!links || !links.length) return false;\r\n        $.each(links, function(index, item) {// 遍历所有a标签，对其进行处理\r\n            var $item = $(item);\r\n            var href = $item.attr('href');\r\n            if(!href) return;\r\n            var params = href.split('?');\r\n            var articleId, categoryId;\r\n            if (params) {\r\n            if (params[0] === 'wkzf://discovery/parameter?articleId=') {// 我读书少，这里怎么还能有问号，不是用问号分割的吗，先保留吧\r\n                if (params[1]) {\r\n                articleId = classSelf.getQueryString(params[1], 'articleId')\r\n                $item.attr('href', '/article/app-share.' + articleId + '.html')\r\n                }\r\n            } else if (params[0] === 'wkzf://discovery/parameter?categoryId=') {\r\n                if (params[1]) {\r\n                categoryId = classSelf.getQueryString(params[1], 'categoryId')\r\n                $item.attr('href', '/category/app.' + categoryId + '.html?cityId=' + classSelf.cityId)\r\n                }\r\n            }\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    convertVideo() {\r\n        var videos = $('.article-content').find('embed');\r\n        if (!videos || !videos.length) return false;\r\n        $.each(videos, function(index, item) {\r\n            var $item = $(item);\r\n            var coverUrl = $.trim($('#coverUrl').val());\r\n            var $video, audio;\r\n            var src = $item.attr('src');\r\n            var split = src && src.split('.');\r\n            var type = split[split.length - 1];\r\n            if (type.toLowerCase() === 'mp3') {\r\n                audio = '<p class=\"weixinAudio\">';\r\n                audio += '<audio src=\"' + src + '\" id=\"media\" width=\"1\" height=\"1\" preload=\"auto\"></audio>';\r\n                audio += '<span id=\"audio_area\" class=\"db audio_area\">';\r\n                audio += '<span class=\"audio_arrow_back\"></span>';\r\n                audio += '<span class=\"audio_arrow\"></span>';\r\n                audio += '<span class=\"audio_wrp db\">';\r\n                audio += '<span class=\"audio_play_area\">';\r\n                audio += '<i class=\"icon_audio_default\"></i>';\r\n                audio += '<i class=\"icon_audio_playing\"></i>';\r\n                audio += '</span>';\r\n                audio += '<span id=\"audio_progress\" class=\"progress_bar\"></span>';\r\n                audio += '</span>';\r\n                audio += '</span>';\r\n                audio += '<span id=\"audio_length\" class=\"audio_length tips_global\"></span>';\r\n                audio += '</p>';\r\n                $item.after($(audio));\r\n                $item.remove();\r\n            } else {\r\n                $video = $('<video src=\"' + $item.attr('src') + '\" controls=\"controls\">您的浏览器不支持 video 标签。</video>');\r\n                $video.attr({\r\n                    poster: coverUrl,\r\n                    preload: 'auto'\r\n                });\r\n                $item.attr({\r\n                    'type': '',\r\n                    'width': '100%',\r\n                    'height': '100%'\r\n                });\r\n                $item.after($video);\r\n                $item.remove();\r\n            }\r\n            $('.weixinAudio').wechatAudio({\r\n                autoplay: false\r\n            });\r\n        });\r\n    }\r\n\r\n    refreshComment() {\r\n        var classSelf = this;\r\n        var PN = new Pagination({\r\n            prePages:4,\r\n            callback: function(pageIndex) {\r\n                pageIndex = pageIndex || 1\r\n                var itemIndex = (pageIndex - 1) * 10\r\n                classSelf.request(classSelf.apiUrl.essay.commentList, {\r\n                    articleId: classSelf.articleId,\r\n                    pageIndex: itemIndex\r\n                },{\r\n                    successCallback: function(result){\r\n                        classSelf.createCommentList(result)\r\n                        $('.pagination').empty()\r\n                        if (!result.count) {\r\n                        $('.pagination').hide()\r\n                        return false\r\n                        } else {\r\n                        $('.pagination').show()\r\n                        }\r\n                        PN.genPageNumber(pageIndex, Math.ceil(result.count / 10))\r\n                    }\r\n                });               \r\n            },\r\n            container: $('.pagination'),\r\n            numberStyle: 'page-number'\r\n        });\r\n    }\r\n    createCommentList(result) {\r\n        var html = [];\r\n        if (!result.data || !result.data.length) return false;\r\n        $('.comment-list').empty();\r\n        $.each(result.data, function(index, item) {\r\n            html.push('<div class=\"item\">');\r\n            html.push('<div class=\"commenter pb-10\">');\r\n            html.push('<img src=\"' + item.guestPhoto + '\" alt=\"\">');\r\n            html.push('<span class=\"name\">' + (item.guestNickname ? item.guestNickname.replace(':', '') : '') + '</span>');\r\n            html.push('</div>');\r\n            html.push('<div class=\"content pb-10\">' + item.commentContent + '</div>');\r\n            html.push('<div class=\"datetime\">');\r\n            html.push('<span class=\"date\">' + item.date + '</span>');\r\n            html.push('<span class=\"time\">' + item.time + '</span>');\r\n            html.push('</div>');\r\n            html.push('</div>');\r\n        })\r\n        $('.comment-list').append(html.join(''));\r\n    }\r\n\r\n    setArticleFont() {\r\n        // 不再采用lib-flexible，同时prd要求所有字体都是16px，黑体，1.75行高。在css中用!important覆盖了所有的.article-content中所有的元素了的样式了\r\n        // var isIPhone = window.navigator.appVersion.match(/iphone/gi)\r\n        // if (isIPhone) {\r\n        //     var dpr = parseInt($('[data-dpr]').attr('data-dpr')) || 1\r\n        //     $('.article-content').find('[style*=font-size]').each(function(index, ele) {\r\n        //     $(ele).css('font-size',$(ele)[0].style.fontSize.replace('px','') * dpr + 'px');\r\n        //     //$(ele).css('font-size', $(ele).css('font-size').replace('px', '') * dpr + 'px')\r\n        //     })\r\n        // }\r\n        $('.article-content [style]').removeAttr('style').removeAttr('class');\r\n        $('.article-content').show();\r\n    }\r\n\r\n    bindEvent() {\r\n        var classSelf = this;\r\n        // 收藏功能，当前没有登录所以隐去\r\n        $('.collect').on('click', function() {\r\n            var _ = $(this);\r\n            var $icon = _.find('i').first();\r\n            Login.isLoginCheck(function() {\r\n                if ($icon.hasClass('icon-shoucang')) {\r\n                    classSelf.Operation.collect({\r\n                        articleId: classSelf.articleId\r\n                    }, function() {\r\n                        $icon.removeClass('icon-shoucang').addClass('icon-yishoucang');\r\n                        classSelf.Operation.showMessage('收藏成功，可至APP收藏中查看！');\r\n                        classSelf.wkBigDataParams.eventName = 1022001;\r\n                        classSelf.wkBigDataParams.eventParam = {\r\n                            article_id: classSelf.articleId,\r\n                            collect: 1\r\n                        };\r\n                        lifang.sendWKBigData(classSelf.wkBigDataParams);\r\n                    });\r\n                }\r\n                if ($icon.hasClass('icon-yishoucang')) {\r\n                    classSelf.Operation.cancelCollection({\r\n                        articleId: classSelf.articleId\r\n                    }, function() {\r\n                        $icon.removeClass('icon-yishoucang').addClass('icon-shoucang');\r\n                        classSelf.wkBigDataParams.eventName = 1022001;\r\n                        classSelf.wkBigDataParams.eventParam = {\r\n                            article_id: classSelf.articleId,\r\n                            collect: 0\r\n                        };\r\n                        lifang.sendWKBigData(classSelf.wkBigDataParams);\r\n                    });\r\n                }\r\n            });\r\n        });\r\n\r\n        // 下载app的条\r\n        this.addListenerToDownloadApp();\r\n\r\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n        下载条的关闭按钮事件赋予\r\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n        $(\".download-app .icon-remove\").click(function(){\r\n            $(\".details-container\").css({ \"padding-bottom\" : 50 }) ;\r\n        }) ;\r\n        $(\".download-app dl\").click(function(){\r\n            var categoryId = $('#categoryId').val();\r\n            var cityId = $('#cityId').val();\r\n            location.href = \"/category/app.\"+ categoryId +\".html?cityId=\" + cityId;\r\n            classSelf.BigData.bigData({\r\n                \"pageName\": \"1022005\",\r\n                \"pageParam\":{\r\n                    \"article_id\": classSelf.articleId\r\n                },            \r\n                \"type\": 2\r\n            });\r\n        });\r\n        \r\n        // var myElement = $('.details-container');\r\n        // var mc = new Hammer(myElement[0]);\r\n\r\n        // mc.on('panup', function() {\r\n        //     if ($('body').scrollTop() > 200) {\r\n        //         $('.discovery-download').hide(0);\r\n        //     }\r\n        // });\r\n\r\n        // mc.on('pandown', function() {\r\n        //     $('.discovery-download').show(0);\r\n        // });\r\n\r\n        $('.zan').on('click', function() {\r\n            var _ = $(this);\r\n            var $icon = _.find('i').first();\r\n\r\n            if (_.hasClass('active')) {                \r\n                $.tips('您已经赞过', 2);\r\n                return;\r\n            }\r\n\r\n            //if ($icon.hasClass('icon-appraise')) {                \r\n                // classSelf.wkBigDataParams.eventName = 1022003;\r\n                // classSelf.wkBigDataParams.eventParam = {\r\n                //     article_id: classSelf.articleId\r\n                // };\r\n                // lifang.sendWKBigData(classSelf.wkBigDataParams);               \r\n\r\n                classSelf.request(classSelf.apiUrl.essay.zan, {\r\n                    articleId: classSelf.articleId\r\n                },{\r\n                    successCallback: function(data){\r\n                        if(data.status ===1 && data.data){\r\n                            var zanCount = _.children('span').text() || 0;\r\n                            if(/^\\d*$/.test(zanCount)){\r\n                                if(parseInt(zanCount)<9999){\r\n                                    zanCount = parseInt(zanCount)+1;\r\n                                }else{\r\n                                    zanCount = '1万+';\r\n                                }\r\n                            }else{\r\n                                zanCount = _.text();\r\n                            }\r\n                            _.addClass('active').find('span').text(data.data);\r\n                           \r\n                        }else{\r\n    \r\n                        }\r\n                    }\r\n                });  \r\n        });\r\n\r\n        $('[name=\"comment\"]').keyup(function() {\r\n            var _ = $(this);\r\n            var val = _.val();\r\n            //console.log(this.scrollHeight);\r\n            //_.height(this.scrollHeight);\r\n            if (val && val.length > 0) {\r\n                _.parent().css('border-color', '#76B4E8');\r\n                $('.comment .submit').css({\r\n                    'color': '#4081D6',\r\n                    'border-color': '#4081D6'\r\n                });\r\n            } else {\r\n                _.parent().css('border-color', '#E4E4E4')\r\n                $('.comment .submit').css({\r\n                    'color': '#999',\r\n                    'border-color': '#999'\r\n                });\r\n            }\r\n        });\r\n\r\n        $('.comment').on('click', '.cancel', function() {\r\n            var com = $('[name=\"comment\"]');\r\n            com.val('').height(classSelf.textareaHeight || 75);\r\n            com.parent().css('border-color', '#E4E4E4');\r\n            $('.comment .submit').css({\r\n                'color': '#999',\r\n                'border-color': '#999'\r\n            });\r\n        });\r\n\r\n        var commiting = false;\r\n        //评论提交事件\r\n        $('.comment').on('click', '.submit', function(event) {\r\n            event.preventDefault();\r\n            if(commiting){\r\n                return;\r\n            }\r\n\r\n            var $textarea = $('[name=comment]');\r\n\r\n            var comment = $.trim($textarea.val());\r\n            if (comment.length === 0) {                \r\n                $.tips('评论内容不能为空', 1);\r\n                return false;\r\n            }     \r\n\r\n            $('.comment .submit').css({\r\n                'color': '#999',\r\n                'border-color': '#999'\r\n            });\r\n            commiting = true;\r\n            classSelf.request(classSelf.apiUrl.essay.comment, {\r\n                articleId: classSelf.articleId,\r\n                comment: comment\r\n            },{\r\n                successCallback: function(data){                    \r\n                    $('.comment .submit').css({\r\n                        'color': '#4081D6',\r\n                        'border-color': '#4081D6'\r\n                    });\r\n                    commiting = false;\r\n                    if(data.status===1 && data.data){                        \r\n                        $.tips('评论成功', 2);                        \r\n                        var $count = $('#comment-box').find('.count');\r\n                        var count = parseInt($count.text()) || 0;\r\n                        var text = $count.text();\r\n                        if (count) {\r\n                            if(data.data.commentNumStr){\r\n                                $count.text(data.data.commentNumStr)\r\n                            }else{\r\n                                if(/^\\d*$/.test(text)){\r\n                                    if(parseInt(text)<9999){\r\n                                        $count.text(parseInt(text) + 1)\r\n                                    }else{\r\n                                        $count.text('1万+');\r\n                                    }\r\n                                }\r\n                            }\r\n                        } else {\r\n                            $('#comment-box').find('.title').empty().append('评论（<span class=\"count\">1</span> )');\r\n                        }\r\n                        $('.no-commet').remove();\r\n                        $textarea.val('');\r\n                        $('.comment .submit').css({\r\n                            'color': '#999',\r\n                            'border-color': '#999'\r\n                        });\r\n                        $('html,body').scrollTop($('#comment-box').offset().top - 200);                        \r\n                        // classSelf.wkBigDataParams.eventName = 1022002;\r\n                        // classSelf.wkBigDataParams.eventParam = {\r\n                        //     article_id: classSelf.articleId\r\n                        // };\r\n                        // lifang.sendWKBigData(classSelf.wkBigDataParams);\r\n                        classSelf.refreshComment();\r\n                    }else{                        \r\n                        $.tips('评论失败', 2);\r\n                    }\r\n                }\r\n            });            \r\n        });\r\n\r\n        window.addEventListener('resize', function(e) {\r\n            var $comment = $('[name=\"comment\"]');\r\n            $comment.scrollIntoView(false);\r\n        });\r\n    }\r\n\r\n    setOptions(opts) {\r\n        var defaults = {};\r\n        $.extend(true, this.options = {}, defaults, opts);\r\n    }\r\n}\r\n\r\n/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n类的初始化\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n$(document).ready(function() {\r\n    new ArticleShareController;\r\n});"]}