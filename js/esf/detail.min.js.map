{"version":3,"sources":["esf/detail.min.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","DetailController","_Controller","this","_this","getPrototypeOf","fiveLine","encryptsubestateid","$","attr","that","request","apiUrl","community","chart","subEstateId","successCallback","data","status","dataRes","echartData","recombineM","echartFun","require","assistant","Album","PreviewImage","BigData","init","bigData","pageName","type","hide","rowNum","Math","round","height","parseFloat","css","addClass","show","removeClass","click","monthList","seriesData","forEach","item","month","date","split","indexOf","push","charAt","unitPrice","sortArray","sort","a","b","maxPrice","ceil","myChart","echarts","document","getElementById","width","houseId","subestateid","echartBigData","eventName","eventParam","house_id","estate_id","option","tooltip","trigger","triggerOn","position","backgroundColor","padding","textStyle","color","fontSize","formatter","params","ticket","callback","paramsValue","grid","bottom","left","right","containLabel","xAxis","splitLine","axisTick","boundaryGap","axisLine","lineStyle","axisLabel","interval","rotate","fontFamily","yAxis","inside","index","min","max","splitNumber","series","name","normal","itemStyle","emphasis","borderColor","borderWidth","setOption","Controller","ready"],"mappings":"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","file":"detail.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n 1. 项目名称：悟空找房h5\r\n 2. 页面名称：esf/detail(二手房-详情)\r\n 3. 作者：liyang@lifang.com\r\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n\r\n\r\nclass DetailController extends Controller {\r\n    constructor() {\r\n        super();\r\n        // 初始化\r\n         this.fiveLine();\r\n        // 获取小区加密Id\r\n        let  encryptsubestateid = $('#estateName').attr('data-encryptsubestateid');\r\n\r\n        // 请求接口\r\n         let that = this;\r\n         this.request(this.apiUrl.community.chart,{subEstateId:encryptsubestateid},{successCallback(data){\r\n             if (data.status == 1){\r\n                 let dataRes = data;\r\n                 let echartData =  that.recombineM(dataRes.data);\r\n                 that.echartFun(echartData) ;\r\n             }\r\n\r\n          }});\r\n        require(['../components/assistant.min','../components/album.min','../components/preview-image.min','../components/bigdata.min'],function(assistant, Album, PreviewImage, BigData){\r\n            BigData.init(that);\r\n            BigData.bigData({\r\n                pageName: '1067',\r\n                type: 1\r\n            });\r\n            PreviewImage('.album');\r\n        });\r\n    }\r\n\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    判断文本是否大于5行\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    fiveLine(){\r\n        $('.more').hide();\r\n        let rowNum=Math.round($(\".base-info\").height()/parseFloat($(\".base-info\").css('line-height')));\r\n        if(rowNum > 5){\r\n            $(\".base-info\").addClass('word-line');\r\n            $('.more').show();\r\n        }else {\r\n            $(\".base-info\").removeClass('word-line');\r\n            $('.more').hide();\r\n        }\r\n        $('.more').click(function () {\r\n            $(\".base-info\").removeClass('word-line');\r\n            $('.more').hide();\r\n        });\r\n    }\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    处理得到的数据的函数  处理月份和数据\r\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    recombineM(data) {\r\n        let echartData = {\r\n            monthList: [],\r\n            seriesData: []\r\n        };\r\n        if (data) {\r\n            data.forEach((item) => {\r\n                let month = item.date.split('-')[1];\r\n                if (month.indexOf('0') == 0) {\r\n                    echartData.monthList.push(month.charAt(1)+'月')\r\n                } else {\r\n                    echartData.monthList.push(month+'月')\r\n                }\r\n                echartData.seriesData.push(item.unitPrice)\r\n            });\r\n        }\r\n        return echartData ;\r\n    }\r\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n   折线图函数异步操作\r\n   -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n    echartFun(echartData){\r\n        let sortArray = echartData.seriesData.sort(function(a, b) {\r\n            return parseFloat(a) - parseFloat(b);\r\n        });\r\n        let maxPrice = Math.ceil((sortArray[sortArray.length - 1] / 10000) + 1) * 10000;\r\n        let myChart = echarts.init(document.getElementById('main'),{ width: '88%' });\r\n        let that = this;\r\n        // 给折线图dome增加埋点\r\n        let houseId =  $('#estateName').attr('data-houseid');\r\n        let subestateid =  $('#estateName').attr('data-subestateid') ;\r\n        let echartBigData = {\r\n            eventName: \"1067014\",\r\n            eventParam: { house_id : houseId , estate_id: subestateid},\r\n            type: 2\r\n        };\r\n        // 指定图表的配置项和数据\r\n        let option = {\r\n            tooltip: {      // 提示框\r\n                trigger: 'item',\r\n                triggerOn: 'click',\r\n                position: 'top',\r\n                backgroundColor: '#92A7C3',\r\n                padding: 4,\r\n                textStyle: {\r\n                    color: '#fff',\r\n                    fontSize: '12'\r\n                },\r\n                formatter:function (params, ticket, callback) {\r\n                    let paramsValue =  params.value + \"元\";\r\n                    that.request(that.apiUrl.bigData , echartBigData ,function () {\r\n\r\n                    });\r\n                    return paramsValue;\r\n                }\r\n            },\r\n            grid: {\r\n                bottom: 20,\r\n                left: '3%',\r\n                right: '10%',\r\n                containLabel: true,\r\n            },\r\n            xAxis: {\r\n                data: echartData.monthList ,  // X坐标数据\r\n                splitLine: {show: false}, // 控制网格线是否显示\r\n                axisTick: {show: false},  // 去除x轴上的刻度线\r\n                position: 'bottom',\r\n                type: 'category',\r\n                boundaryGap: false,\r\n                axisLine: {\r\n                    lineStyle: {\r\n                        color: '#979797', // x轴颜色\r\n                    }\r\n                },\r\n                axisLabel: {\r\n                    interval: 0,\r\n                    rotate: 0, //60度角倾斜显示\r\n                    textStyle: {\r\n                        color: '#999',\r\n                        fontSize: 12,\r\n                        fontFamily: '微软雅黑'\r\n                    }\r\n                },\r\n            },\r\n            yAxis: {\r\n                axisLine: {show: false},   // y轴是否显示\r\n                splitLine: {\r\n                    show: true,  // 控制网格线是否显示\r\n                    lineStyle: {\r\n                        color: ['#979797'] // y刻度颜色\r\n                    }\r\n                },\r\n                axisTick: {show: false},// 去除y轴上的刻度线\r\n                axisLabel:{\r\n                    inside: false,\r\n                    textStyle: {\r\n                        color: '#999',\r\n                    },\r\n                    formatter: function(value, index) {\r\n                        if (value == 0) {\r\n                            return \"\";\r\n                        } else {\r\n                            return value / 10000 + '万';\r\n                        }\r\n                    }\r\n                },\r\n                min:0,\r\n                max:maxPrice,\r\n                splitNumber: 4,\r\n                interval: maxPrice / 4\r\n            },\r\n            series: [{\r\n                name: '销量',\r\n                type: 'line',\r\n                lineStyle:{\r\n                    normal:{\r\n                        color:'#92A7C3', // 折线条颜色\r\n                    }\r\n\r\n                },\r\n                itemStyle:{\r\n                    normal:{\r\n                        color: \"#92A7C3\" //图标颜色\r\n                    },\r\n                    emphasis: { //重点，强调时候的样式，即当鼠标悬停或点击上去的时候的拐点的样式\r\n                        borderColor: '#92A7C3',\r\n                        borderWidth: 2,\r\n                        color: '#92A7C3'\r\n                    }\r\n                },\r\n                data: echartData.seriesData,\r\n\r\n            }],\r\n        };\r\n        myChart.setOption(option);\r\n\r\n        /*$('#main > div:eq(1)').attr('data-bigdata',encodeURIComponent(JSON.stringify(echartBigData)));*/\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n类的初始化\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\r\n$(document).ready(function() {\r\n    new DetailController;\r\n});"]}