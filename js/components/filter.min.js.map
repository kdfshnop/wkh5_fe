{"version":3,"sources":["components/filter.min.js"],"names":["templateSettings","evaluate","interpolate","escape","noMatch","escaper","escapeChar","match","escapes","_template","text","settings","oldSettings","$","extend","matcher","RegExp","source","join","index","replace","offset","slice","length","variable","render","Function","e","template","data","call","argument","define","DEFAULT","el","filterChanged","condition","prices","id","houseTypes","name","title","items","exclusive","sorts","near","createPriceSection","templateStr","html","createHouseTypeSection","count","createSortSection","createDistrictAndMetroSection","options","console","log","latitude","longitude","districts","metros","distances","create","calcCondition","result","each","sort","price","key","find","value","undefined","push","bindEvent","self","hide","$content","removeClass","$body","show","$districtMetro","$price","$houseType","$sort","slideDown","$districtLabel","parent","addClass","$priceLabel","$houseTypeLabel","$sortLabel","click","hasClass","apply","$minPrice","val","$maxPrice","minText","trim","maxText","min","parseInt","max","str","$this","$parent","closest","$items","filter","$houseTypeResetBtn","$houseTypeConfirmBtn","$metro","$district","siblings","district","town","metro","station","districtPinyin","metroKey","meter","indexOf","event","target","setMaxHeight","winHeight","window","height","css","getDistrictAndMetro","houseType","cityId","cb","initCount","controller","request","apiUrl","rent","list","cityAreas","successCallback","init","errorCallback","exceptionCallback","citySubway","$el","$priceConfirmBtn","initValue","pageUrl","location","href","tmpArr","split","obj","ParamGenerator","queryString2Object","convert2FilterParam","setValue","Filter","prototype","$pr","strs","i","clear","clearDistrictAndMetro"],"mappings":"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","file":"filter.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n 1. 项目名称：悟空找房h5\n 2. 页面名称：components -> filter(筛选条件)\n 3. 作者：tangxuyang@lifang.com\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n /**\n  * options: {\n      el: \"\", //挂载点\n      houseType: \"\",//查询区域板块用的\n      cityId: \"\",//查询区域板块和地铁用的\n      cityName: \"\",\n      near: true,\n      longitude: \"\",// 经度\n      latitude: \"\",// 纬度\n      distances: [{value: \"5000\", text: \"不限（智能范围）\"},{value: \"500\", text: \"500米\"},{value: \"1000\", text: \"1000米\"},{value: \"2000\", text: \"2000米\"},{value: \"5000\", text: \"5000米\"}],\n      filterChanged: function(condition){\n        condition:{\n            price: \"\",\n            sort: \"\",\n            district: \"\",\n            town: \"\",\n            metro: \"\",\n            station: \"\",\n            districtPinyin: \"\",\n            metroKey: \"\"\n            ...\n        }\n\n      },//查询条件变化回调\n      prices:[{\n          id: \"\",\n          text: \"不限\"          \n      },{\n          id: \"1\",\n          text: \"100万以下\"\n      }],\n      houseTypes:[{\n          name: \"types\",//用来作为返回查询条件的key\n          title: \"户型\",\n          items: [{\n              id: \"\",\n              text: \"不限\",\n              exclusive: true,//互斥\n          }]\n      },{\n          name: \"features\",\n          title: \"特色\",\n          items: [{\n              id: \"\",\n              text: \"进地铁\"\n          }]\n      },{\n          name: \"propertyTypes\",\n          title: \"物业类型\",\n          items: [{\n              id: \"\",\n              text: \"住宅\"\n          }]\n      },{\n          name: \"decorations\",\n          title: \"装修\",\n          items: [{\n              id: \"\",\n              text: \"毛坯\"\n          }]\n      }],\n      sorts:[{\n          id: \"\",\n          text: \"综合排序\"\n      }]\n  }\n\n  filteChange的参数: {\n    sort: \"\", //排序\n    price: \"\",//价格\n    district: \"\",//区域id\n    town: \"\",//板块id\n    metro: \"\",//地铁线id\n    station: \"\",//地铁站id\n    .... // 对应options中houseTypes的name\n  }\n  */\n\n/*\n* ---------------------------取自underscore----------------------------\n*/\nvar templateSettings = {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g\n};\n\nvar noMatch = /(.)^/;\n\nvar escaper = /\\\\|'|\\r|\\n|\\u2028|\\u2029/g;\n\nvar escapeChar = function(match) {\n    return '\\\\' + escapes[match];\n};\n\nvar _template = function(text, settings, oldSettings) {\n    if (!settings && oldSettings) settings = oldSettings;\n    settings = $.extend({}, settings, templateSettings);\n\n    var matcher = RegExp([\n        (settings.escape || noMatch).source,\n        (settings.interpolate || noMatch).source,\n        (settings.evaluate || noMatch).source\n    ].join('|') + '|$', 'g');\n\n    var index = 0;\n    var source = \"__p+='\";\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n        source += text.slice(index, offset).replace(escaper, escapeChar);\n        index = offset + match.length;\n\n        if (escape) {\n            source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\n        } else if (interpolate) {\n            source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\n        } else if (evaluate) {\n            source += \"';\\n\" + evaluate + \"\\n__p+='\";\n        }\n        \n        return match;\n    });\n    source += \"';\\n\";\n\n    if (!settings.variable) source = 'with(obj||{}){\\n' + source + '}\\n';\n\n    source = \"var __t,__p='',__j=Array.prototype.join,\" +\n        \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\n        source + 'return __p;\\n';\n\n    try {\n        var render = new Function(settings.variable || 'obj', '_', source);\n    } catch (e) {\n        e.source = source;\n        throw e;\n    }\n\n    var template = function(data) {\n        return render.call(this, data);\n    };\n\n    var argument = settings.variable || 'obj';\n    template.source = 'function(' + argument + '){\\n' + source + '}';\n\n    return template;\n};\n\n/*\n* ----------------------------------------------------------------------\n*/\ndefine([],function(){\n    const DEFAULT =  {\n        el: \"\", //挂载点\n        filterChanged: function(condition){},//查询条件变化回调\n        prices:[{\n            id: \"\",\n            text: \"不限\"          \n        },{\n            id: \"1\",\n            text: \"100万以下\"\n        },{\n            id: \"2\",\n            text: \"100-150万\"\n        },{\n            id: \"3\",\n            text: \"150-200万\"\n        },{\n            id: \"4\",\n            text: \"200-250万\"\n        },{\n            id: \"5\",\n            text: \"250-300万\"\n        },{\n            id: \"6\",\n            text: \"300-500万\"\n        },{\n            id: \"7\",\n            text: \"500-1000万\"\n        },{\n            id: \"8\",\n            text: \"1000-2000万\"\n        },{\n            id: \"9\",\n            text: \"2000万以上\"\n        }],\n        houseTypes:[{\n            name: \"types\",//用来作为返回查询条件的key\n            title: \"户型\",\n            items: [{\n                id: \"\",\n                text: \"不限\",\n                exclusive: true,//互斥\n            },{\n                id: \"1\",\n                text: \"一室\",\n                exclusive: false,//互斥\n            },{\n                id: \"2\",\n                text: \"二室\",\n                exclusive: false,//互斥\n            },{\n                id: \"3\",\n                text: \"三室\",\n                exclusive: false,//互斥\n            },{\n                id: \"4\",\n                text: \"四室\",\n                exclusive: false,//互斥\n            },{\n                id: \"5\",\n                text: \"五室及以上\",\n                exclusive: false,//互斥\n            }]\n        },{\n            name: \"features\",\n            title: \"特色\",\n            items: [{\n                id: \"f1\",\n                text: \"近地铁\"\n            },{\n                id: \"s1\",\n                text: \"即将开盘\"\n            },{\n                id: \"s2\",\n                text: \"在售楼盘\"\n            },{\n                id: \"f0\",\n                text: \"有优惠\"\n            },{\n                id: \"f2\",\n                text: \"有视频\"\n            }]\n        },{\n            name: \"propertyTypes\",\n            title: \"物业类型\",\n            items: [{\n                id: \"1\",\n                text: \"住宅\"\n            },{\n                id: \"2\",\n                text: \"别墅\"\n            },{\n                id: \"3\",\n                text: \"商用\"\n            }]\n        },{\n            name: \"decorations\",\n            title: \"装修\",\n            items: [{\n                id: \"1\",\n                text: \"毛坯\"\n            },{\n                id: \"2\",\n                text: \"精装\"\n            },{\n                id: \"3\",\n                text: \"豪装\"\n            }]\n        }],\n        sorts:[{\n            //id: \"-1\",\n            text: \"综合排序\"\n        },{\n            id: \"1\",\n            text: \"均价从低到高\"\n        },{\n            id: \"2\",\n            text: \"均价从高到低\"\n        },{\n            id: \"3\",\n            text: \"面积从小到大\"\n        },{\n            id: \"4\",\n            text: \"面积从大到小\"\n        }],\n        near: true\n    };\n    \n    function createPriceSection(prices){// 价格\n        var templateStr = '<div class=\"total-price\">\\\n                                <ul>\\\n                                <%for(var i = 0; i < prices.length; i++){%>\\\n                                    <li data-value=\"<%=prices[i].id%>\"><%=prices[i].text%></li>\\\n                                <%}%>\\\n                                </ul>\\\n                                <div>\\\n                                    <div>\\\n                                        <input type=\"number\" placeholder=\"最低价格\">\\\n                                    </div>\\\n                                    <div class=\"normal\">-</div>\\\n                                    <div>\\\n                                        <input placeholder=\"最高价格\" type=\"number\">\\\n                                    </div>\\\n                                    <div class=\"normal\"></div>\\\n                                    <div>\\\n                                        <button type=\"button\">确定</button>\\\n                                    </div>\\\n                                </div>\\\n                            </div>';\n        var html = _template(templateStr)({prices:prices});        \n        return html;\n    }\n\n    function createHouseTypeSection(houseTypes){// 户型        \n        var templateStr = '<div class=\"house-type\">\\\n                            <div class=\"house-type-inner\">\\\n                                <% var c = count || 4;%>\\\n                                <%for(var i = 0; i < houseTypes.length; i++){%>\\\n                                    <div class=\"house-type-section\" data-key=\"<%= houseTypes[i].name%>\">\\\n                                        <h4><%= houseTypes[i].title%></h4>\\\n                                        <%var r = Math.ceil(houseTypes[i].items.length/c);%>\\\n                                        <%for(var j = 0; j < r; j++){%>\\\n                                            <ul>\\\n                                            <%for(var k = 0; k < c; k++){%>\\\n                                              <%var item = houseTypes[i].items[j*c +k];%>\\\n                                              <%if(item){%>\\\n                                              <li data-value=\"<%= item.id%>\" data-exclusive=\"<%= item.exclusive?1:0%>\"><%= item.text %></li>\\\n                                              <%}else{%>\\\n                                                <li class=\"placeholder\"></li>\\\n                                              <%}%>\\\n                                            <%}%>\\\n                                            </ul>\\\n                                        <%}%>\\\n                                    </div>\\\n                                    <%}%></div>\\\n                                    <ul class=\"operation\">\\\n                                        <li class=\"reset\">重置</li>\\\n                                        <li class=\"confirm\">确定</li>\\\n                                    </ul>\\\n                            </div>';\n        \n        var html = _template(templateStr)({houseTypes: houseTypes, count: 4});\n        return html;\n    }\n\n    function createSortSection(sorts){// 排序\n        var templateStr = '<div class=\"sort\">\\\n                                <ul>\\\n                                <%for(var i = 0; i < sorts.length; i++){%>\\\n                                    <li data-value=\"<%= sorts[i].id%>\"><%= sorts[i].text%></li>\\\n                                <%}%>\\\n                                </ul>\\\n                            </div>';\n        var html = _template(templateStr)({sorts: sorts});\n        return html;        \n    }\n\n    function createDistrictAndMetroSection(options){// 区域（包括区域和地铁）\n        var templateStr = '<div class=\"district-metro\"><ul><li class=\"active\">区域</li><li>地铁</li></ul><div class=\"district district-metro-item\">\\\n                                <div class=\"district-inner\">\\\n                                    <ul class=\"parent\">\\\n                                        <%if(near){%>\\\n                                        <li data-value=\"near\" class=\"near\"><%= latitude && longitude ? \"附近\" : \"定位失败\"%></li>\\\n                                        <%}%>\\\n                                        <li>不限</li>\\\n                                        <%for(var i = 0; i< districts.length; i++){%>\\\n                                        <li data-value=\"<%= districts[i].id%>\"><%= districts[i].name%></li>\\\n                                        <%}%>\\\n                                    </ul>\\\n                                    <div class=\"child\">\\\n                                    <%if(longitude && latitude){%>\\\n                                        <ul data-value=\"near\" class=\"near\">\\\n                                            <%for(var i = 0; distances && i < distances.length; i++){%>\\\n                                                <li class=\"near\" data-value=\"<%=distances[i].value%>\"><%= distances[i].text%></li>\\\n                                            <%}%>\\\n                                        </ul>    \\\n                                    <%}%>\\\n                                    <%for(var i = 0; i < districts.length; i++){%>\\\n                                        <ul data-value=\"<%= districts[i].id%>\" data-text=\"<%= districts[i].name%>\">\\\n                                            <li data-pinyin=\"<%=districts[i].pinyin%>\">不限</li>\\\n                                            <%for(var j = 0; j < districts[i].townList.length; j++){%>\\\n                                                <li data-pinyin=\"<%=districts[i].pinyin%>-<%=districts[i].townList[j].pinyin%>\" data-value=\"<%= districts[i].townList[j].id%>\"><%= districts[i].townList[j].name%></li>\\\n                                            <%}%>\\\n                                        </ul>\\\n                                    <%}%>\\\n                                    </div>\\\n                                </div>\\\n                            </div>\\\n                            <div class=\"metro district-metro-item\">\\\n                            <div class=\"metro-inner\">\\\n                                <ul class=\"parent\">\\\n                                    <li>不限</li>\\\n                                    <%for(var i = 0; i< metros.length; i++){%>\\\n                                    <li data-value=\"<%= metros[i].id%>\"><%= metros[i].name%></li>\\\n                                    <%}%>\\\n                                </ul>\\\n                                <div class=\"child\">\\\n                                <%for(var i = 0; i < metros.length; i++){%>\\\n                                    <ul data-value=\"<%= metros[i].id%>\" data-text=\"<%= metros[i].name%>\">\\\n                                        <li data-pinyin=\"<%=metros[i].key%>\">不限</li>\\\n                                        <%for(var j = 0; j < metros[i].subList.length; j++){%>\\\n                                            <li data-pinyin=\"<%=metros[i].key%><%=metros[i].subList[j].key%>\" data-value=\"<%= metros[i].subList[j].id%>\"><%= metros[i].subList[j].name%></li>\\\n                                        <%}%>\\\n                                    </ul>\\\n                                <%}%>\\\n                            </div>\\\n                        </div>\\\n                        </div></div>';\n        console.log(\"经纬度：\", options.latitude, options.longitude);\n        var html = _template(templateStr)({districts: options.districts, metros: options.metros, longitude: options.longitude, latitude: options.latitude, distances: options.distances, near: options.near});        \n        return html;\n    }\n\n    function create(){\n        var options = this.options;\n        return '<ul class=\"filter-items\"><li><span class=\"label\">区域</span><span class=\"triangle\"></span></li><li><span class=\"label\">总价</span><span class=\"triangle\"></span></li><li><span class=\"label\">户型</span><span class=\"triangle\"></span></li><li><span class=\"label\">排序</span><span class=\"triangle\"></span></li></ul><div class=\"content\"><div class=\"content-inner\">'+createDistrictAndMetroSection(options)+createPriceSection(options.prices)+createHouseTypeSection(options.houseTypes)+createSortSection(options.sorts)+'</div></div>';\n    }\n\n    // 计算查询提交，并调用filterChange回调\n    function calcCondition() {\n        var result = {};\n        // 排序\n        $('.sort .active').each(function(){\n            result.sort = $(this).data('value');\n        });\n\n        // 总价\n        $('.total-price .active').each(function(){\n            result.price = $(this).data('value');\n        });\n        // TODO:读取自定义总价\n\n        // 户型\n        $('.house-type-section').each(function(){\n            var key = $(this).data('key');\n            result[key] = [];\n            $(this).find('.active').each(function(){\n                var value = $(this).data('value');\n                if(value != null && value != undefined && value != ''){\n                    result[key].push(value);\n                }                    \n            });\n            if(result[key].length == 0){// 没选中则删除\n                delete result[key];\n            }\n        });\n\n        // 区域地铁\n        /*\n        $('.district .parent li.active').each(function(){\n            result.district = $(this).data('value');\n        });\n        $('.district .child li.active').each(function(){\n            result.town = $(this).data('value');\n        });\n        $('.metro .parent li.active').each(function(){\n            result.metro = $(this).data('value');\n        });\n        $('.metro .child li.active').each(function(){\n            result.station = $(this).data('value');\n        });*/\n        // 区域地铁的有点复杂，还是在点击选中时直接复制给this.result\n        \n        result = $.extend({}, this.result, result);\n        this.options.filterChanged && this.options.filterChanged(result);        \n    }\n\n    function bindEvent() {\n        var self = this;\n        \n        // 关闭筛选弹层\n        function hide(){            \n            self.$content.hide();\n            $('.filter .filter-items li').removeClass('open');\n            self.$body.removeClass('noscroll');\n        }\n\n        // 打开筛选弹层\n        function show(index){\n            // 先隐藏\n            self.$districtMetro.hide();\n            self.$price.hide();\n            self.$houseType.hide();\n            self.$sort.hide();\n\n            $('.filter-items li').removeClass('open');            \n            self.$content.show();\n            switch(index){\n                case 0:\n                    self.$districtMetro.slideDown();\n                    self.$districtLabel.parent().addClass('open');\n                break;\n                case 1:\n                    self.$price.slideDown();\n                    self.$priceLabel.parent().addClass('open');\n                break;\n                case 2:\n                    self.$houseType.slideDown();\n                    self.$houseTypeLabel.parent().addClass('open');\n                break;\n                case 3:\n                    self.$sort.slideDown();\n                    self.$sortLabel.parent().addClass('open');\n                break;\n            }\n            self.$body.addClass('noscroll');\n        }\n\n        // 点击区域、总价、户型、排序，展示详情筛选条件\n        $('.filter-items li').click(function(){\n            if($(this).hasClass('open')){//当前筛选条件已经显示了，则关闭                \n                hide();\n            }else{\n                var index = $('.filter-items li').index(this);                                        \n                show(index);                \n            }\n        });\n\n        // 点击排序中的选项\n        $('.filter .sort li').click(function(){            \n            self.$sort.find('li').removeClass('active');\n            $(this).addClass('active');\n            hide();\n            calcCondition.apply(self);\n            var id = $(this).data('value');\n            if(id){\n                self.$sortLabel.text($(this).text()).parent().addClass('active');\n            } else {\n                self.$sortLabel.text(\"排序\").parent().removeClass('active');\n            }\n        });\n\n        // 点击总价中的选项\n        $('.filter .total-price li').click(function(){            \n            self.$price.find('li').removeClass('active');\n            $(this).addClass('active');\n            hide();\n            var id = $(this).data('value');\n            if(id) {\n                self.$priceLabel.text($(this).text()).parent().addClass('active');;\n            } else {\n                self.$priceLabel.text(\"总价\").parent().removeClass('active');\n            }\n            self.$minPrice.val('');\n            self.$maxPrice.val('');\n            calcCondition.apply(self);\n        });\n\n        // 自定义价格区间确定按钮\n        $('.filter .total-price button').click(function(){\n            // 校验输入，并做相应处理\n            var minText = $.trim(self.$minPrice.val());\n            var maxText = $.trim(self.$maxPrice.val());\n            var min = parseInt(minText) || 0;\n            var max = parseInt(maxText) || 0;\n\n            if(min != minText && minText || max != maxText && maxText || min > max) {\n                // TODO:提示价格区间有误，请从新输入\n\n                return;\n            }\n            self.result.price = (min || 0) + \"to\" + (max || 0);\n            if(self.result.price==\"0to0\"){\n                delete self.result.price;\n            }\n            var str = \"\";\n            if(!min && max){\n                str = max + \"万以下\";\n            } else if (min && !max) {\n                str = min + \"万以上\";\n            } else if (min && max) {\n                str = min + \"-\" + max + \"万\";\n            }\n            if(str) {\n                self.$priceLabel.text(str).parent().addClass('active');\n            }else{\n                self.$priceLabel.text(\"总价\").parent().removeClass('active');\n            }\n            self.$price.find('li').removeClass('active');\n            hide();\n            calcCondition.apply(self);\n        });\n\n        // 户型中选项\n        $('.filter .house-type-section li:not(.placeholder)').click(function(){\n            var $this = $(this);\n            if($this.hasClass('active')){// 已经选中了，则去除选中\n                $this.removeClass('active');\n            }else{                \n                // 互斥处理\n                var $parent = $this.closest('.house-type-section');\n                var $items = $parent.find('li:not(.placeholder)');\n                if($this.data('exclusive')){//互斥\n                    $items.removeClass('active');\n                }else{// 不互斥\n                    $items.filter('[data-exclusive=1]').removeClass('active');\n                } \n                $this.addClass('active');               \n            }                        \n        });\n\n        // 户型中重置和确定按钮\n        self.$houseTypeResetBtn.click(function(){\n            self.$houseType.find('.house-type-section li:not(.placeholder)').removeClass('active');\n            //$('.filter .house-type-section li:not(.placeholder)').removeClass('active');\n        });\n        self.$houseTypeConfirmBtn.click(function(){\n            if(self.$houseType.find('.active').length > 0){\n                self.$houseTypeLabel.parent().addClass('active');\n            }else{\n                self.$houseTypeLabel.parent().removeClass('active');\n            }\n            hide();\n            calcCondition.apply(self);\n        });\n\n        //区域中，区域地铁单击\n        $('.filter .district-metro >ul li').click(function(){\n            var index = $('.filter .district-metro >ul li').index(this);\n            if(index == 0){// 点击的区域                                \n                self.$metro.hide();\n                self.$district.show();\n            } else {// 地铁                \n                self.$metro.show();\n                self.$district.hide();\n            }\n            $(this).siblings().removeClass('active');\n            $(this).addClass('active');\n        });\n\n        // 区域、地铁\n        $('.filter .parent li').click(function(){\n            var $this = $(this);\n            var id = $this.data('value');            \n            $this.siblings().removeClass('active');\n            $this.addClass('active');\n            var $parent = $this.parent();\n            $parent.siblings('.child').find('ul').hide().filter('[data-value='+id+']').show();\n            if(!id){// 不限\n                delete self.result.district;\n                delete self.result.town;\n                delete self.result.metro;\n                delete self.result.station; \n                delete self.result.districtPinyin;\n                delete self.result.metroKey;\n                hide();\n                calcCondition.apply(self);    \n                self.$districtLabel.text(\"区域\").parent().removeClass('active');           \n            }\n        });\n\n        // 板块、地铁站\n        $('.filter .district .child li').click(function(){\n            var $this = $(this);\n            $('.district-metro .child li').removeClass('active');\n            $this.addClass('active');\n            delete self.result.metro;\n            delete self.result.station;\n            delete self.result.metroKey;\n            delete self.result.district;\n            delete self.result.town;\n            delete self.result.districtPinyin;\n            delete self.result.longitude;\n            delete self.result.latitude;\n            delete self.result.meter;\n\n            var str = \"\";\n            \n            if($this.hasClass('near')){//附近中选项                \n                self.result.longitude = self.options.longitude;\n                self.result.latitude = self.options.latitude;\n                self.result.meter = $this.data('value');\n                str = $this.text();\n                if(str.indexOf('不限')> -1){\n                    str = \"附近\";\n                }\n            }else{\n                self.result.district = $this.parent().data('value');\n                self.result.town = $this.data('value');\n                self.result.districtPinyin = $this.data('pinyin');\n                if(!self.result.town){// 不限\n                    str = $this.parent().data('text');\n                } else {\n                    str = $this.text();\n                }\n            }\n            \n            calcCondition.apply(self);\n            hide();\n            \n            self.$districtLabel.text(str).parent().addClass('active');\n        });\n        $('.filter .metro .child li').click(function(){\n            var $this = $(this);\n            $('.district-metro .child li').removeClass('active');\n            $this.addClass('active');\n            delete self.result.district;\n            delete self.result.town;\n            delete self.result.districtPinyin;\n            delete self.result.longitude;\n            delete self.result.latitude;\n            delete self.result.meter;\n            self.result.metro = $this.parent().data('value');\n            self.result.station = $this.data('value');\n            self.result.metroKey = $this.data('pinyin');\n            calcCondition.apply(self);\n            hide();\n            var str = \"\";\n            if(!self.result.station) {// 不限\n                str = $this.parent().data('text');\n            } else {\n                str = $this.text();\n            }\n            self.$districtLabel.text(str).parent().addClass('active');\n        });\n\n        // 点击遮罩关闭筛选条件\n        $('.content').click(function(event){\n            if(this == event.target) {\n                hide();\n            }\n        });\n    }\n\n    // 设置弹层的高度\n    function setMaxHeight(){\n        var winHeight = $(window).height();\n        this.$districtMetro.find('.parent,.child').css('max-height', winHeight * .7 + \"px\");\n        this.$price.find('ul').css('max-height', winHeight * .7 + \"px\");\n        this.$houseType.find('.house-type-inner').css('max-height', winHeight * .7 + \"px\");\n        this.$sort.css('max-height', winHeight * .7 + \"px\");\n        this.$content.height(winHeight);\n    }\n\n    function getDistrictAndMetro(houseType, cityId, cb){\n        initCount = 0;\n        // 查询区域板块\n        var self = this;\n        this.controller.request(this.controller.apiUrl.rent.list.cityAreas,{\n            houseType: this.options.houseType,\n            cityId: this.options.cityId\n        },{\n            successCallback: function(data){\n                self.options.districts = data.data;\n                init.apply(self);\n                console.log('area: success');\n            },\n            errorCallback: function(){\n                self.options.districts = [];\n                init.apply(self);\n                console.log('area: error');\n            },\n            exceptionCallback: function(){\n                self.options.districts = [];\n                init.apply(self);\n                console.log('area: exception');\n            }\n        });\n\n        // 查询地铁\n        this.controller.request(this.controller.apiUrl.rent.list.citySubway,{            \n            cityId: this.options.cityId\n        },{\n            successCallback: function(data){\n                self.options.metros = data.data;\n                init.apply(self);\n                console.log('subway: success');\n            },\n            errorCallback: function(){\n                self.options.metros = [];\n                init.apply(self);\n                console.log('subway: error');\n            },\n            exceptionCallback: function(){\n                self.options.metros = [];\n                init.apply(self);\n                console.log('subway: exception');\n            }\n        });\n    }\n\n    var initCount = 0;\n    function init(){\n        initCount++;        \n        if(initCount!=2){// 获取区域和地铁是两个接口，因此这里要确定它们都已经成功返回了\n            return;\n        }\n        this.$el.html(create.apply(this));\n        this.$content = this.$el.find('.content');\n        this.$body = $('body');\n        // 筛选条中的内容\n        this.$districtLabel = this.$el.find('.filter-items li:eq(0) .label');\n        this.$priceLabel = this.$el.find('.filter-items li:eq(1) .label');\n        this.$houseTypeLabel = this.$el.find('.filter-items li:eq(2) .label');\n        this.$sortLabel = this.$el.find('.filter-items li:eq(3) .label');\n        // 各个筛选条件的内容\n        this.$districtMetro = this.$el.find('.district-metro');\n        this.$price = this.$el.find('.total-price');\n        this.$houseType = this.$el.find('.house-type');\n        this.$sort = this.$el.find('.sort');\n        // \n        this.$district = this.$districtMetro.find('.district');\n        this.$metro = this.$districtMetro.find('.metro');\n        this.$minPrice = this.$price.find('input:eq(0)');\n        this.$maxPrice = this.$price.find('input:eq(1)');\n        this.$priceConfirmBtn = this.$price.find('button');\n        this.$houseTypeResetBtn = this.$houseType.find('.reset');\n        this.$houseTypeConfirmBtn = this.$houseType.find('.confirm');\n\n        \n        //this.result = {};\n        //this.initValue = this.$el.data('init');//不从dom节点上读了，这样加大了node端对条件的解析，filter本身直接读取url，分析\n\n        //--- 读取url 并分析初始条件-----------------\n        this.initValue = {};\n        var pageUrl = location.href;\n        pageUrl = pageUrl.replace('//','');\n        var tmpArr = pageUrl.split('/');\n        if(tmpArr[3]){// 有查询条件\n            var obj = ParamGenerator.queryString2Object(tmpArr[3]);\n            if(obj){\n                this.initValue = ParamGenerator.convert2FilterParam(obj);\n            }\n        }\n\n        //--- end-----------------------------------\n\n        // if(this.initValue){\n        //     this.initValue = JSON.parse(decodeURIComponent(this.initValue));\n        // }else{\n        //     this.initValue = {};\n        // }\n        if(this.$el.length == 0) {\n            throw \"挂载点不存在\";\n        }\n        \n        this.setValue(this.initValue);\n        bindEvent.apply(this);\n        setMaxHeight.apply(this);\n    }\n\n    function Filter(options) {                \n        this.options = $.extend({},DEFAULT, options);                            \n        this.$el = $(options.el);\n        this.controller = options.controller;        \n\n        getDistrictAndMetro.apply(this);  \n    }\n\n    // 根据指定的值设置控件中各个筛选条件选中值\n    Filter.prototype.setValue = function(value){\n        /**\n         * {\n         *  district: \"\",\n         *  town: \"\",\n         *  metro: \"\",\n         *  station: \"\",\n         * \n         *  price: \"\",\n         *  houseTypes:{\n         *      key: []...\n         *  },\n         *  sort: \"\"\n         * }\n         */        \n        // 区域/地铁\n        var str = \"\";\n        this.result = {};                \n        if(value.district != undefined || value.town != undefined){            \n            if(value.district != undefined) {\n                str = this.$district.find('.parent li[data-value='+value.district+']').addClass('active').text();\n                this.$district.find('.child ul[data-value='+value.district+']').show();\n                this.result.district = value.district;\n                this.result.districtPinyin = this.$district.find('.child ul[data-value='+value.district+'] li:eq(0)').data('pinyin');\n            }\n            if(value.town != undefined) {\n                str = this.$district.find('.child li[data-value='+value.town+']').addClass('active').text();\n                this.result.town = value.town;\n                this.result.districtPinyin = this.$district.find('.child li[data-value='+value.town+']').data('pinyin');\n            }                    \n        } else if(value.metro != undefined || value.station != undefined){        \n            if(value.metro != undefined) {\n                str = this.$metro.find('.parent li[data-value='+value.metro+']').addClass('active').text();\n                this.$metro.find('.child ul[data-value='+value.metro+']').show();\n                this.result.metro = value.metro;\n                this.result.metroKey = this.$metro.find('.child ul[data-value='+value.metro+'] li:eq(0)').data('pinyin');\n            }\n            if(value.station != undefined) {\n                str = this.$metro.find('.child li[data-value='+value.station+']').addClass('active').text();\n                this.result.station = value.station;\n                this.result.metroKey = this.$metro.find('.child li[data-value='+value.station+']').data('pinyin');\n            }\n\n            $('.filter .district-metro >ul li').removeClass('active').filter(':eq(1)').addClass('active');\n                       \n            this.$district.hide();\n            this.$metro.show();\n        }else{// 清空选中的区域地铁\n            this.$districtMetro.find('ul, li').removeClass('active');\n            this.$districtMetro.find('.child ul').hide();\n            this.$districtLabel.text('区域').parent().removeClass('active');\n            this.$district.show();\n            this.$metro.hide();\n            this.$districtMetro.find('>ul li:eq(0)').addClass('active');\n            delete this.result.district;\n            delete this.result.districtPinyin;\n            delete this.result.town;\n            delete this.result.metro;\n            delete this.result.metroKey;\n            delete this.result.station;\n        }\n        if(str){// 设置选中区域或地铁站到区域内容中\n            this.$districtLabel.text(str).parent().addClass('active');\n        }\n\n        // 总价\n        if(value.price) {\n            this.$price.find('li').removeClass('active');\n            var $pr = this.$price.find('[data-value='+value.price+']');\n            if($pr.length == 0){// 不是选项而是自定义价格\n                var strs = value.price.split('to');\n                var min = strs[0];\n                var max = strs[1];\n                this.$minPrice.val(min||\"\");\n                this.$maxPrice.val(max||\"\");\n                this.result.price = value.price;\n                if(!min){\n                    str = max + \"万以下\";\n                } else if(!min){\n                    str = min + \"万以上\";\n                } else {\n                    str = min + \"-\" + max + \"万\";\n                }\n            } else {// 选项                \n                $pr.addClass('active');\n                this.result.price = value.price;\n                str = $pr.text();\n            }\n            this.$priceLabel.text(str).parent().addClass('active');\n        }else{\n            this.$price.find('li').removeClass('active');\n            this.$maxPrice.val('');\n            this.$minPrice.val('');\n            this.$priceLabel.text('总价').parent().removeClass('active');\n            delete this.result.price;\n        }\n\n        // 户型\n        if(value.houseTypes){\n            // 先清空\n            this.$houseType.find('li').removeClass('active');\n            this.$houseTypeLabel.text('户型').parent().removeClass('active');\n\n            for(var key in value.houseTypes) {\n                for(var i = 0; i < value.houseTypes[key].length; i++){\n                    this.$houseType.find('[data-key='+key+'] [data-value='+value.houseTypes[key][i]+']').addClass('active');\n                }                \n            }\n\n            this.$houseTypeLabel.parent().addClass('active');\n        }\n\n        // 排序\n        if(value.sort){            \n            var str = this.$sort.find('li[data-value='+value.sort+']').addClass('active').text();\n            if(str){\n                this.$sortLabel.text(str).parent().addClass('active');\n            }\n            this.result.sort = value.sort;\n        }else{\n            delete this.result.sort;\n            this.$sort.find('li').removeClass('active');\n            this.$sortLabel.text('排序').parent().removeClass('active');\n        }\n    }\n\n    Filter.prototype.clear = function() {\n        this.setValue({});        \n        calcCondition.apply(this);\n    }\n\n    Filter.prototype.clearDistrictAndMetro = function(){\n        this.$districtMetro.find('.parent li').removeClass('active');\n        this.$districtMetro.find('.child li').removeClass('active');\n        this.$districtLabel.text('区域').parent().removeClass('active');\n        delete this.result.district;\n        delete this.result.town;\n        delete this.result.metro;\n        delete this.result.station;\n        delete this.result.districtPinyin;\n        delete this.result.metroKey;\n        delete this.result.meter;\n        delete this.result.longitude;\n        delete this.result.latitude;\n    }\n\n    return Filter;\n});"]}