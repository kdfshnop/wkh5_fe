"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),ListController=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),a=e;e.paramGenerator=new ParamGenerator,setTimeout(function(){$(".total").slideUp()},3e3),$(".lazy").lazyload({placeholder:e.staticDomain+"/wkh5_fe/images/common/loading.jpg"}),require(["../components/filter.min","../components/bigdata.min","../components/conning-tower.min"],function(e,t){t.init(a),new ConningTower({bigDataUtil:t,moduleType:"xf",cityClick:function(e){},searchResultItemClick:function(e){delete a.param.di,delete a.param.to,delete a.param.li,delete a.param.st,delete a.param.id,delete a.param.sdi,delete a.param.sto,delete a.param.sli,delete a.param.sst,delete a.param.sid,delete a.param.lat,delete a.param.lon,delete a.param.m;var t=["","sdi","sto","sli","sst","sid"],i=t[e.type];i&&(a.param[i]=e.value,a["goto"]())}});var i=$("#visitedCityId").val(),n=[3,43,1873,1950,873,771,221,741],o=0==n.filter(function(e){return e==i}).length?e.LOWPRICES:null;a.filter=new e($.extend({},e.XFDEFAULT,{el:".filter",cityId:i,near:!1,controller:a,BigData:t,filterChanged:function(e){var t=a.paramGenerator.generateParamObj(e);if(t.di||t.to||t.li||t.st||t.lat||t.lon);else{var i=["sdi","sto","sli","sst","sid"];i.forEach(function(e){a.param[e]&&(t[e]=a.param[e])})}a.param=t,a["goto"]()}},o)),a.BigData=t,t.bigData({pageName:"1050",type:1})});var i=location.origin+location.pathname;i=i.replace("//","");var n=i.split("/");if(a.param={},n[3]){var o=ParamGenerator.queryString2Object(n[3]);o&&(a.param=o)}return window.filter=a.filter,e.bindEvent(),e.pullload(),e.insertTrendAndOldHouse(),e}return _inherits(t,e),_createClass(t,[{key:"goto",value:function(){var e=$("#visitedCityPinyin").val(),t=location.origin+"/"+e+"/xflist/"+ParamGenerator.object2QueryString(this.param);location.href=t+location.search}},{key:"bindEvent",value:function(){$(".no-data button").click(function(){location.href="./"})}},{key:"createHouseItems",value:function(e){var t="",a=$("#visitedCityPinyin").val(),i=$("#channel").val();return e.forEach(function(e){t+='<a class="xf-item" href="/'+a+"/xf/"+e.encryptSubEstateId+".html"+(i?"?channel="+i:"")+'" data-bigdata="'+encodeURIComponent('{"eventName": "1050025", "eventParam": {"new_house_id":"'+e.subEstateId+'"}}')+'">                <div class="img">                    <img src="'+e.imageUrl+'">'+("1"==e.hasVideo&&'<span class="play"><i></i></span>'||"")+'                    <div class="yh">'+(e.activitys&&e.activitys[0]&&e.activitys[0].title||"")+'</div>                </div>                <div class="info">                    <h3>'+e.estateName+'</h3>                    <p class="district-town-area">                        <span>'+e.districtName+" "+e.townName+"</span><span>"+e.startSpace+"m²-"+e.endSpace+'m²</span>                    </p>                    <ul class="tags">'+("1"==e.hasActivity&&'<li class="yh">有优惠</li>'||"")+("1"==e.isSubwayEstate&&'<li class="dt">近地铁</li>'||"")+("1"==e.isOnSale&&"2"!=e.isSoonOpen&&"<li>在售楼盘</li>"||"<li>即将开盘</li>")+("1"==e.hasVideo&&"<li>有视频</li>"||"")+'</ul>                    <p class="unit-price"><span>'+("0"!=e.avgPriceWou?e.avgPriceWou:"价格待定")+"</span> "+("0"!=e.avgPriceWou&&"<span>元/m²</span>"||"")+"</p>                </div>            </a>"}),t}},{key:"createHouseList",value:function(e,t){if(this.hideNoData(),e&&e.length){$(".no-data").hide();var a=this.createHouseItems(e);$("#list").html(a),$(".total .count").text(t),$(".total").slideDown(),setTimeout(function(){$(".total").slideUp()},1500),this.insertTrendAndOldHouse()}else this.showNoData()}},{key:"appendHouseList",value:function(e){if(e&&e.length){var t=this.createHouseItems(e);$("#list").append(t),this.insertTrendAndOldHouse()}}},{key:"showNoData",value:function(){$(".no-data").show(),$(".total + div").html(""),$(".recommendation").show()}},{key:"hideNoData",value:function(){$(".no-data").hide()}},{key:"hideNoMore",value:function(){$(".reach-bottom").hide()}},{key:"insertTrendAndOldHouse",value:function(){var e=$("#visitedCityName").val(),t=$("#visitedCityPinyin").val(),a=$("#visitedCityId").val(),i=$("#channel").val(),n=$("#list .xf-item"),o=$("#oldBusiness").val();0==$("#list .scene.house-price").length&&n.length>9&&$('<a data-bigdata="'+encodeURIComponent(JSON.stringify({eventName:"1050056",eventParam:{city_id:a}}))+'" href="/'+t+"/trend/new"+(i?"?channel="+i:"")+'" class="scene house-price">                <div class="img"></div>                <div class="info">                    <h3>'+e+'房价涨了还是跌了？</h3>                    <span class="detail">去看看</span>                </div>            </a>').insertAfter($(n[9])),o&&0==$("#list .scene.house").length&&n.length>19&&$('<a data-bigdata="'+encodeURIComponent(JSON.stringify({eventName:"1050057",eventParam:{city_id:a}}))+'" href="/'+t+"/esf/"+(i?"?channel="+i:"")+'" class="scene house">                <div class="img"></div>                <div class="info">                    <h3>火爆高性价比二手房</h3>                    <span class="detail">去看看</span>                </div>            </a>').insertAfter(n[19])}},{key:"showError",value:function(){}},{key:"pullload",value:function(){var e=this;$("#list").pullload({apiUrl:e.apiUrl.xf.list,itemClass:".xf-item",queryStringObject:function(){return e.param&&delete e.param.pa,e.param||(e.param={}),$.extend({},e.param,{cityId:$("#visitedCityId").val()})},requestType:"POST",threshold:50,pageSize:10,pageIndexKey:"of",pageSizeKey:"ps",callback:function(t){return t.data&&t.data.newHouseDataListModelList&&t.data.newHouseDataListModelList.length?void e.appendHouseList(t.data.newHouseDataListModelList):void(t.count=1)}})}}]),t}(Controller);$(document).ready(function(){new ListController});
//# sourceMappingURL=list.min.js.map
